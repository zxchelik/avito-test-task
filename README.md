
# ๐ ะะฒะธัะพ Test Assignment

ะกะตัะฒะธั ะดะปั ัะฐะฑะพัั ั pull request.
ะกัะตะบ: **Golang**, **Chi**, **pgxpool**, **PostgreSQL**
ะััะธัะตะบัััะฐ: **ะงะธััะฐั ะฐััะธัะตะบัััะฐ (Clean Architecture)**

---

## ๐ ะะฐะฟััะบ

### ๐น Docker

```bash
make run
# ะธะปะธ
docker compose up -d
```

ะะพัะปะต ััะฐััะฐ ัะตัะฒะธั ะฑัะดะตั ะดะพัััะฟะตะฝ ะฟะพ ะฐะดัะตัั(ะธะปะธ ะดััะณะพะผั,ะบะพัะพััะน ะฑัะดะตั ัะบะฐะทะฐะฝ ะฒ ะบะพะฝัะธะณััะฐัะธะธ):

```
http://localhost:8080 
```

---

## โ๏ธ ะะพะฝัะธะณััะฐัะธั

ะะพะฝัะธะณััะฐัะธั ะฟะพ ัะผะพะปัะฐะฝะธั ััะฐะฝะธััั ะฒ:

```
/configs/server/default.yaml
```

ะะปั ัะบะฐะทะฐะฝะธั ะดััะณะพะณะพ ัะฐะนะปะฐ ะบะพะฝัะธะณะฐ ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั:

```bash
export CONFIG_PATH="configs/server/default.yaml"
```

> ะะฝะฐัะตะฝะธั ะพะบััะถะตะฝะธั (ะฝะฐะฟัะธะผะตั, ะฟะฐัะฐะผะตััั ะฟะพะดะบะปััะตะฝะธั ะบ Postgres) ะผะพะณัั **ะฟะตัะตะทะฐะฟะธััะฒะฐัั YAML-ะบะพะฝัะธะณ**, ััะพ ะฟะพะทะฒะพะปัะตั ััะฐะฝะธัั ัะตะบัะตัั ะฒ `.env`.

---

## ๐งฉ ะัะพะฑะตะฝะฝะพััะธ ัะตะฐะปะธะทะฐัะธะธ

### ะขัะฐะฝะทะฐะบัะธะพะฝะฝัะน ะผะตะฝะตะดะถะตั

ะะตะฐะปะธะทะพะฒะฐะฝ ะผะตะฝะตะดะถะตั ััะฐะฝะทะฐะบัะธะน, ะฟะพะทะฒะพะปัััะธะน ะฒัะฟะพะปะฝััั ะพะฟะตัะฐัะธะธ ะธะท ัะฐะทะฝัั ัะตะฟะพะทะธัะพัะธะตะฒ ะฒ ัะฐะผะบะฐั **ะพะดะฝะพะน ััะฐะฝะทะฐะบัะธะธ**.
ะัะธะผะตั: ัะพะทะดะฐะฝะธะต ะบะพะผะฐะฝะดั ะธ ะตั ััะฐััะฝะธะบะพะฒ ะบะฐะบ ะฐัะพะผะฐัะฝะฐั ะพะฟะตัะฐัะธั:

```go
err := s.tx.WithinTransaction(ctx, func(txCtx context.Context) error {
    if err := s.teams.Create(txCtx, team.Name); err != nil {
        return err
    }

    createdTeam = team
    createdMembers = make([]*modeluser.User, 0, len(members))

    for _, m := range members {
        m.TeamName = team.Name

        if err := s.users.Upsert(txCtx, m); err != nil {
            return err
        }

        createdMembers = append(createdMembers, m)
    }

    return nil
})
```

ะัะตะธะผััะตััะฒะฐ:
โ ะบะพะฝัะธััะตะฝัะฝะพััั ะดะฐะฝะฝัั
โ ะฒะพะทะผะพะถะฝะพััั ะพะฑัะตะดะธะฝััั ะพะฟะตัะฐัะธะธ ะฝะตัะบะพะปัะบะธั ัะตะฟะพะทะธัะพัะธะตะฒ
โ ะฟัะพััะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ัะตัะฒะธัะฐั

---

## ๐ก ะะตััะธะบะธ

ะะพะฑะฐะฒะปะตะฝ endpoint ั ะผะตััะธะบะฐะผะธ (**ัะพะฒะผะตััะธะผ ั Grafana/Prometheus**):

```
/metrics
```

---

## ๐ ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะทะฐะดะฐะฝะธั

| ะคัะฝะบัะธะพะฝะฐะปัะฝะพััั         |      ะกัะฐััั      |
| ------------------------ | :--------------: |
| ะะธะฝัะตั (`golangci-lint`) |         โ        |
| ะะตััะธะบะธ                  |         โ        |
| ะะฐะณััะทะพัะฝะพะต ัะตััะธัะพะฒะฐะฝะธะต |         โ        |
| K6 ะฝะฐะณััะทะพัะฝัะน ัะตัั      | `make load-test` |

> โ๏ธ ะขัะตะฑัะตััั ะทะฐัะฐะฝะตะต ัััะตััะฒัััะธะน ะฟะพะปัะทะพะฒะฐัะตะปั **u1** ะดะปั ะทะฐะณััะทะพัะฝะพะณะพ ัะตััะฐ.

---

## ๐ ะะตะทัะปััะฐัั ะฝะฐะณััะทะพัะฝะพะณะพ ัะตััะธัะพะฒะฐะฝะธั

```
THRESHOLDS
โ http_req_duration: p(95)<300ms (ัะฐะบั: 12.04ms)

TOTAL
http_req_duration..............: avg=6.16ms min=1.55ms med=5.14ms max=56.52ms p(90)=10.49ms p(95)=12.04ms
http_req_failed................: 0.00% (0/1501)
http_reqs......................: 1501 (5.00/s)
iteration_duration.............: avg=6.53ms min=1.79ms med=5.50ms max=56.77ms p(90)=10.90ms p(95)=12.49ms
iterations.....................: 1501 (5.00/s)
```

### ๐ข ะัะฒะพะด

> 95-ะน ะฟะตััะตะฝัะธะปั โ **12ms ะฟัะธ ะดะพะฟัััะธะผัั <300ms**
> ะัะธะฑะพะบ โ **0%**

ะกะตัะฒะธั ัะพะพัะฒะตัััะฒัะตั ััะตะฑะพะฒะฐะฝะธัะผ ะฟะพ **ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ ะธ ััะฐะฑะธะปัะฝะพััะธ** โ

---

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
.
โโโ cmd
โ       โโโ server
โโโ configs
โ        โโโ server
โโโ goose
โโโ internal
โ        โโโ application
โ        โโโ httpserver
โ        โโโ infrastructure
โ        โโโ model
โ        โโโ repository
โ        โโโ service
โโโ migrations
โโโ pkg
    โโโ logger

```

---
